\documentclass[showtrims]{memoir}
\setstocksize{276mm}{213mm}
% If I were printing a4, then I would have a textblock of 201mm x 293mm
% \settrimmedsize{276mm}{213mm}{*}
\settrimmedsize{*}{201mm}{1.296}
\setulmarginsandblock{1.5cm}{1.5cm}{*}
% \setlrmarginsandblock{1.5cm}{1.5cm}{*}
% TODO figure out how to set the block, and then the margins because the block
% needs to be 0cm between the spine (i.e. right block margin = 0cm for odd
% pages) Margins at 1.5cm seems sensible, but might need shrinking by 6mm to
% accomodate the change in trimmed size (for my printer's sake)
\setlrmarginsandblock{3cm}{0cm}{*}
\checkandfixthelayout

\renewcommand{\familydefault}{\sfdefault}

\usepackage{pdfpages}
\usepackage{tikz}
\usetikzlibrary{shapes,positioning}

\newcommand\pyramidtitle[2]{
  \cleartooddpage
  \vspace*{\fill}
  \begin{center}
    \section{Pyramid #1 -- #2}
  \end{center}
  \vspace*{\fill}
}

\pgfmathsetmacro{\issuehelpercounter}{2cm}
\newcommand\issuehelper[4]{
  \checkoddpage
  \ifoddpage
  \begin{tikzpicture}[remember picture,overlay]
    \node[below=\issuehelpercounter pt of current page.north east] (start) {};
    % \coordinate (start) at (current page.north east);
    \node[below left=2cm and 1.0cm of start] (finish) {};
    % \coordinate (finish) at (current page.center);
    \draw[draw=none,fill=black!20] (start) rectangle (finish) node[midway,align=center,rotate=90, text width=1.9cm, color=white,inner sep=0.1cm,font={\scriptsize\bfseries}] {\#3/#2 -- #3};
  \end{tikzpicture}
  \else
  \begin{tikzpicture}[remember picture,overlay]
    \node[below=\issuehelpercounter pt of current page.north west] (start) {};
    % \coordinate (start) at (current page.north east);
    \node[below right=2cm and 1.0cm of start] (finish) {};
    % \coordinate (finish) at (current page.center);
    \draw[draw=none,fill=black!20] (start) rectangle (finish) node[midway,align=center,rotate=-90, text width=1.9cm, color=white,inner sep=0.1cm,font={\scriptsize\bfseries}] {\#3/#2 -- #3};
  \end{tikzpicture}
  \fi
}

\newcommand\pyramidissue[4]{
  \pgfmathsetmacro{\issuehelpercounter}{\issuehelpercounter + 2cm}
  \IfFileExists{#1}{
    \pyramidtitle{#2}{#3}
    \includepdf[
    % TODO make it switch 
    pagecommand={\issuehelper{#1}{#2}{#3}{#4}},
    pages={#4}]{#1}
  }{}
}

\begin{document}
\title{Pyramid home omnibus}
\author{Various}
\maketitle
\tableofcontents

% This issue has maps, should sort that for home printing!
\pyramidissue{build/Pyramid_3_98_Welcome_to_Dungeon_Fantasy.pdf}{98}{Welcome to
  Dungeon Fantasy}{2-9,11-28,30-35}
\pyramidissue{build/Pyramid_3_99_Death_and_Beyond.pdf}{99}{Death and Beyond}{2-11,13-28,30-37}
\pyramidissue{build/Pyramid_3_100_Pyramid_Secrets.pdf}{100}{Pyramid Secrets}{2-15,17-26,28-35}
\pyramidissue{build/Pyramid_3_101_Humor.pdf}{101}{Humor}{2-8,10-25,27-36}
% \pyramidissue{build/Pyramid_3_102_Epic.pdf}{102}{Epic}{2-14,16-29,31-38}
\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
